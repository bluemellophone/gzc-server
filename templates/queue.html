{% extends "layout.html" %}
{% block content %}
    <script type="text/javascript">
        var ready = {};
        var processed = {};
        
        var data_url = "{{ url_for('status') }}";
            
        $( document ).ready( function() {
            template = '' + 
                '<tr>' + 
                '    <th scope="row">{0}</th>' + 
                '    <td>{1}</td>' + 
                '    <td>{2} / {3}</td>' + 
                '    <td>{4}</td>' + 
                '    <td>{5}</td>' + 
                '    <td>{6}</td>' + 
                '    <td>{7}</td>' + 
                '</tr>';

            $.getJSON(data_url)
                .success(function( data ) {
                    console.log(data);
                    $("#source").html("<pre>" + syntaxHighlight(data) + "</pre>");

                    $.each( data.data.cars, function( key_car, car ) {
                        $.each( car.persons, function( key_person, person ) {
                            content = template.format(
                                key_car,
                                key_person,
                                person.submitted_images,
                                person.submitted_generated_json,
                                person.analyzed,
                                person.reviewed_posted,
                                person.reviewed_rendered,
                                person.reviewed_printed
                                
                            );
                            $("#content").append(content);
                        });
                    });
                })
                .error(function() { 
                    $("#source").html("ERROR LOADING STATUS");
                });
        });
    </script>
    <div class="jumbotron" style="background-color: transparent;">
    
    <table class="table table-hover">
        <thead>
            <tr>
                <th>Car</th>
                <th>Person</th>
                <th>Submitted<br/>(Images / GPS)</th>
                <th>Analysed</th>
                <th>Posted</th>
                <th>Rendered</th>
                <th>Printed</th>
            </tr>
        </thead>
        <tbody id="content">
        </tbody>
    </table>

    </div>
    <div class="jumbotron" id="source"></div>
{% endblock %}